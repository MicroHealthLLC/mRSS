<fieldset>
  <legend></legend>
  <%= form_for([@room, meeting], remote: true, html: { class: 'form-horizontal'}) do |f| %>

          <div id="error_explanation">

          </div>

      <div class="form-group">
        <%= f.label 'Title', class: 'col-md-3 control-label' %>
        <div class="col-md-9">
          <%= f.hidden_field :room_id  %>
          <%= f.text_field :name , class: 'form-control' %>
        </div>
      </div>


      <div class="form-group">
        <%= f.label 'Description' , class: 'col-md-3 control-label' %>
        <div class="col-md-9">
          <%= f.text_area :description , class: 'form-control ck-editor' %>
        </div>
      </div>

      <div class="form-group" >
        <%= f.label 'Date', class: 'col-md-3 control-label' %>
        <div class="col-md-9">
          <div class="mdp"></div>
          <% if meeting.new_record?
               meeting.meeting_dates.build(date: Date.today)
          end %>

          <%= text_field_tag :date, meeting.meeting_dates.map(&:date).map(&:to_date), class: 'date form-control', style: "position:relative; display: none" %>
        </div>
      </div>

      <div class="form-group">
        <%= f.label 'Time start', class: 'col-md-3 control-label' %>
        <div class="col-md-9">
          <%= f.text_field :time_start , value: (meeting.time_start || Time.now).strftime('%I:%M%p'), class: 'form-control timepicker' %>
        </div>
      </div>

      <div class="form-group">
        <%= f.label 'Time end' , class: 'col-md-3 control-label' %>
        <div class="col-md-9">
          <%= f.text_field :time_end , value: (meeting.time_end || Time.now).strftime('%I:%M%p'), class: 'form-control timepicker', style: "position:relative" %>
        </div>
      </div>

      <div class="form-group" >
        <div class="col-md-12">
          <%if meeting.persisted?%>
          <%= link_to 'Delete', room_meeting_path(@room, meeting), method: :delete, data: {confirm: 'Are you sure?'}, class: 'btn btn-danger pull-right' %>
          <%end %>
          <%= link_to 'Cancel', '#', {class: 'btn btn-warning pull-right cancel_meeting_modal', data: { dismiss: 'modal' }} %>
          <%= f.submit 'Save', class: 'btn btn-success pull-right' %>
        </div>
      </div>
  <% end %>
</fieldset>

<script>
  function resetModal(){
      $('#error_explanation').html('');
      $('.mdp').multiDatesPicker('resetDates', 'picked');
      $('.mdp').multiDatesPicker('addDates', [new Date()]);
  }
  $('#EditMeeting, #NewMeeting').on('hidden.bs.modal', function () {
    resetModal();
  })
  $('.mdp').multiDatesPicker({
      dateFormat: "yy-mm-dd",
      altField: '.date',
      addDates: <%= raw meeting.meeting_dates.map(&:date).map(&:to_date).map(&:to_s) %>,
      minDate: 0,
      "prevText":'<i class="fa fa-chevron-left"></i>',
      "nextText":'<i class="fa fa-chevron-right"></i>'
  })
</script>